import streamlit as st
import random
import os

try:
    from sklearn.feature_extraction.text import TfidfVectorizer
    from sklearn.metrics.pairwise import cosine_similarity

    _SKLEARN_AVAILABLE = True
except ImportError:
    _SKLEARN_AVAILABLE = False

try:
    import spacy

    _SPACY_AVAILABLE = True
except ImportError:
    _SPACY_AVAILABLE = False

try:
    import Levenshtein

    _LEVENSHTEIN_AVAILABLE = True
except ImportError:
    _LEVENSHTEIN_AVAILABLE = False


# –û–ø—Ä–µ–¥–µ–ª–∏–º –∞–ª—Ñ–∞–≤–∏—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤ (—Ä—É—Å—Å–∫–∏–µ —Å—Ç—Ä–æ—á–Ω—ã–µ + –ø—Ä–æ–±–µ–ª)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –∞–ª—Ñ–∞–≤–∏—Ç. –î–æ–±–∞–≤–∏–º –ø—Ä–æ–±–µ–ª, —Ç.–∫. –æ–Ω —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–∞—Ö.
RUSSIAN_ALPHABET = '–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è '

# --- –§—É–Ω–∫—Ü–∏–∏ –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¢–µ–∫—Å—Ç–æ–≤ ---
def generate_random_letters(length: int) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Ä—É—Å—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞ –∏ –ø—Ä–æ–±–µ–ª–∞."""
    if length <= 0:
        return ""
    return ''.join(random.choices(RUSSIAN_ALPHABET, k=length))

@st.cache_resource
def load_spacy_model(model_name: str = "ru_core_news_md"):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –∫—ç—à–∏—Ä—É–µ—Ç —è–∑—ã–∫–æ–≤—É—é –º–æ–¥–µ–ª—å spaCy."""
    if not _SPACY_AVAILABLE:
        return None
    try:
        nlp = spacy.load(model_name, disable=['parser', 'ner'])
        st.success(f"–ú–æ–¥–µ–ª—å spaCy '{model_name}' —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∞.")
        return nlp
    except OSError:
        st.error(f"‚ùå –ú–æ–¥–µ–ª—å spaCy '{model_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. "
                 f"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–∫–∞—á–∞–π—Ç–µ –µ—ë, –≤—ã–ø–æ–ª–Ω–∏–≤ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: "
                 f"python -m spacy download {model_name}")
        return None
    except Exception as e:
        st.error(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å spaCy '{model_name}': {e}")
        return None

@st.cache_data
def load_word_list(filepath: str = "russian.txt") -> list[str]:
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏: —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –ø–æ –∫—Ä–∞—è–º
    (–≤–∫–ª—é—á–∞—è —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç—Ä–æ–∫–∏ '\n') –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏.

    Args:
        filepath (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å–ø–∏—Å–∫–æ–º —Å–ª–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É —Å–ª–æ–≤—É –Ω–∞ —Å—Ç—Ä–æ–∫—É).

    Returns:
        list[str]: –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤.
                   –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—É—Å—Ç –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è,
                   –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
                   –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Streamlit.
    """
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç
    default_word_list = [
        "—Ç–µ–∫—Å—Ç", "—Å–ª–æ–≤–æ", "–±—É–∫–≤–∞", "—è–∑—ã–∫", "–∞–Ω–∞–ª–∏–∑", "—Ñ–∞–π–ª", "—Å–ø–∏—Å–æ–∫", "—Å–ª—É—á–∞–π–Ω—ã–π",
        "–≥–µ–Ω–µ—Ä–∞—Ü–∏—è", "–∞–ª–≥–æ—Ä–∏—Ç–º", "—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ", "—Å–∏—Å—Ç–µ–º–∞", "–ø—Ä–æ–≥—Ä–∞–º–º–∞", "–¥–∞–Ω–Ω—ã–µ",
        "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "—Ä–µ–∑—É–ª—å—Ç–∞—Ç", "–æ—Ç—á–µ—Ç", "–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å", "–∫–æ–¥"
    ]

    word_list = []

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª
    if not os.path.exists(filepath):
        st.warning(f"‚ö†Ô∏è –§–∞–π–ª —Å–ª–æ–≤–∞—Ä—è '{filepath}' –Ω–µ –Ω–∞–π–¥–µ–Ω. "
                   f"–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–µ–±–æ–ª—å—à–æ–π —Å–ª–æ–≤–∞—Ä—å.")
        return default_word_list

    try:
        with open(filepath, 'r', encoding='windows-1251') as f:
            lines = f.readlines()
            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É: —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã/–ø–µ—Ä–µ–Ω–æ—Å—ã –ø–æ –∫—Ä–∞—è–º (.strip())
            # –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ –ø—É—Å—Ç–∞—è.
            word_list = [line.strip() for line in lines if line.strip()]

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ–∫–∞–∑–∞–ª—Å—è –ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç—ã–º –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
        if not word_list:
            st.warning(f"‚ö†Ô∏è –§–∞–π–ª —Å–ª–æ–≤–∞—Ä—è '{filepath}' –ø—É—Å—Ç –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–ª–æ–≤ "
                       f"–ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏. –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–µ–±–æ–ª—å—à–æ–π —Å–ª–æ–≤–∞—Ä—å.")
            return default_word_list

        st.success(f"–°–ª–æ–≤–∞—Ä—å '{filepath}' —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω. "
                   f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤: {len(word_list):,}")
        return word_list

    except Exception as e:
        st.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ —Å–ª–æ–≤–∞—Ä—è '{filepath}': {e}. "
                 f"–ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–µ–±–æ–ª—å—à–æ–π —Å–ª–æ–≤–∞—Ä—å.")
        return default_word_list


# --- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤ ---
def generate_random_words(length: int, word_list_filepath: str = "russian.txt") -> str:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤, –≤–∑—è—Ç—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ —Å–ª–æ–≤–∞—Ä—è.
    –°–ª–æ–≤–∞ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –æ–¥–Ω–∏–º –ø—Ä–æ–±–µ–ª–æ–º. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ —Ç–æ—á–Ω–æ–π –¥–ª–∏–Ω—ã `length`.

    Args:
        length (int): –¢—Ä–µ–±—É–µ–º–∞—è –¥–ª–∏–Ω–∞ –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏.
        word_list_filepath (str): –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–ª–æ–≤–∞—Ä—è –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ load_word_list.

    Returns:
        str: –°—Ç—Ä–æ–∫–∞, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤, –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã.
             –í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–ª–æ–≤–∞—Ä—è –∏–ª–∏ –µ—Å–ª–∏ length <= 0,
             –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ —Å—Ç—Ä–æ–∫—É –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤
             (–µ—Å–ª–∏ —Å–ª–æ–≤–∞—Ä—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω).
    """
    if length <= 0:
        return ""

    # –ó–∞–≥—Ä—É–∂–∞–µ–º (–∏–ª–∏ –ø–æ–ª—É—á–∞–µ–º –∏–∑ –∫—ç—à–∞) —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤
    # –§—É–Ω–∫—Ü–∏—è load_word_list —Å–∞–º–∞ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—à–∏–±–∫–∏ –∏ –≤–µ—Ä–Ω–µ—Ç –ª–∏–±–æ —Å–ª–æ–≤–∞ –∏–∑ —Ñ–∞–π–ª–∞,
    # –ª–∏–±–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫.
    actual_word_list = load_word_list(word_list_filepath)

    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –¥–∞–∂–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
    # (—Ö–æ—Ç—è –æ–Ω –∑–∞–¥–∞–Ω –∂–µ—Å—Ç–∫–æ, –Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏)
    if not actual_word_list:
        st.error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ (–¥–∞–∂–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π). "
                 "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.")
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
        return ""

    result_text = ""
    separator = " "

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç, –ø–æ–∫–∞ –µ–≥–æ –¥–ª–∏–Ω–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç –∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç —Ç—Ä–µ–±—É–µ–º—É—é
    while len(result_text) < length:
        word = random.choice(actual_word_list)

        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å (–ø—Ä–æ–±–µ–ª)
        # –ü—Ä–æ–±–µ–ª –Ω—É–∂–µ–Ω, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç —É–∂–µ –Ω–µ –ø—É—Å—Ç–æ–π
        add_separator = len(result_text) > 0

        # –î–ª–∏–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ–º–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ (–ø—Ä–æ–±–µ–ª + —Å–ª–æ–≤–æ)
        fragment_len = len(word) + (len(separator) if add_separator else 0)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–º–µ—Å—Ç–∏—Ç—Å—è –ª–∏ –Ω–æ–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ö–æ—Ç—è –±—ã —á–∞—Å—Ç–∏—á–Ω–æ
        # –ï—Å–ª–∏ –¥–∞–∂–µ –ø–µ—Ä–≤—ã–π —Å–∏–º–≤–æ–ª —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –Ω–µ –≤–ª–µ–∑–∞–µ—Ç, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è
        if len(result_text) + (1 if add_separator else 0) > length:
            break

        # –î–æ–±–∞–≤–ª—è–µ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç (–ø—Ä–æ–±–µ–ª + —Å–ª–æ–≤–æ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–æ)
        if add_separator:
            result_text += separator + word
        else:
            result_text += word

        # –ù–µ–±–æ–ª—å—à–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –µ—Å–ª–∏ –¥–ª–∏–Ω–∞ —É–∂–µ —Å–∏–ª—å–Ω–æ –ø—Ä–µ–≤—ã—Å–∏–ª–∞ –Ω—É–∂–Ω—É—é, –º–æ–∂–Ω–æ –ø—Ä–µ—Ä–≤–∞—Ç—å—Å—è —Ä–∞–Ω—å—à–µ,
        # —Ç.–∫. –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥–µ–º –æ–±—Ä–µ–∑–∞—Ç—å. –ú–Ω–æ–∂–∏—Ç–µ–ª—å 1.1 –¥–∞–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–ø–∞—Å.
        if len(result_text) > length * 1.1:
            break

    # –û–±—Ä–µ–∑–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ –¢–û–ß–ù–û–ô —Ç—Ä–µ–±—É–µ–º–æ–π –¥–ª–∏–Ω—ã
    # –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–µ–∑–∞–Ω–∏–µ [:length] —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä—è–º—ã–º —Å–ø–æ—Å–æ–±–æ–º
    # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ —Å—Ç—Ä–æ–≥–æ–π –¥–ª–∏–Ω–µ.
    return result_text[:length]


# --- –§—É–Ω–∫—Ü–∏—è –°—Ä–∞–≤–Ω–µ–Ω–∏—è –¢–µ–∫—Å—Ç–æ–≤ ---
def compare_texts(text1: str, text2: str) -> tuple[str, float | None]:
    """
    –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–∞ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂: (—Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ, –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏–ª–∏ None).
    """
    len1 = len(text1)
    len2 = len(text2)

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
    if len1 == 0 or len2 == 0:
        return "–û—à–∏–±–∫–∞: –û–¥–∏–Ω –∏–ª–∏ –æ–±–∞ —Ç–µ–∫—Å—Ç–∞ –ø—É—Å—Ç—ã. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.", None

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–ª–∏–Ω—ã
    if len1 != len2:
        diff = abs(len1 - len2)
        if len1 > len2:
            msg = f"–û—à–∏–±–∫–∞: –¢–µ–∫—Å—Ç 1 ({len1} —Å–∏–º–≤.) –¥–ª–∏–Ω–Ω–µ–µ –¢–µ–∫—Å—Ç–∞ 2 ({len2} —Å–∏–º–≤.) –Ω–∞ {diff} —Å–∏–º–≤–æ–ª–æ–≤. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –¥–∞–Ω–Ω–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É —Ç—Ä–µ–±—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã."
        else:
            msg = f"–û—à–∏–±–∫–∞: –¢–µ–∫—Å—Ç 2 ({len2} —Å–∏–º–≤.) –¥–ª–∏–Ω–Ω–µ–µ –¢–µ–∫—Å—Ç–∞ 1 ({len1} —Å–∏–º–≤.) –Ω–∞ {diff} —Å–∏–º–≤–æ–ª–æ–≤. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –¥–∞–Ω–Ω–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É —Ç—Ä–µ–±—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã."
        return msg, None
    else:
        # –ü–æ–¥—Å—á–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        matches = 0
        for i in range(len1):
            if text1[i] == text2[i]:
                matches += 1

        # –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        percentage = matches / len1
        msg = f"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ. –î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤: {len1}. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Ç–µ—Ö –∂–µ –ø–æ–∑–∏—Ü–∏—è—Ö: {matches}."
        return msg, percentage

def calculate_tfidf_similarity(text1: str, text2: str) -> tuple[str, float | None]:
    """–í—ã—á–∏—Å–ª—è–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ TF-IDF –≤–µ–∫—Ç–æ—Ä–æ–≤."""
    if not _SKLEARN_AVAILABLE:
        return "–û—à–∏–±–∫–∞: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ scikit-learn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.", None
    if not text1 or not text2:
        return "–û—à–∏–±–∫–∞: –û–¥–∏–Ω –∏–ª–∏ –æ–±–∞ —Ç–µ–∫—Å—Ç–∞ –ø—É—Å—Ç—ã –¥–ª—è TF-IDF.", None

    try:
        vectorizer = TfidfVectorizer()
        # –°–æ–∑–¥–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É TF-IDF –¥–ª—è –æ–±–æ–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ –≤–º–µ—Å—Ç–µ
        tfidf_matrix = vectorizer.fit_transform([text1, text2])
        # –í—ã—á–∏—Å–ª—è–µ–º –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º –∏ –≤—Ç–æ—Ä—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º
        similarity = cosine_similarity(tfidf_matrix[0:1], tfidf_matrix[1:2])[0][0]
        msg = "TF-IDF –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ."
        return msg, float(similarity)  # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º float
    except Exception as e:
        return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ TF-IDF: {e}", None


def calculate_embedding_similarity(text1: str, text2: str, nlp_model) -> tuple[str, float | None]:
    """–í—ã—á–∏—Å–ª—è–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ spaCy."""
    if not _SPACY_AVAILABLE or nlp_model is None:
        return "–û—à–∏–±–∫–∞: –ú–æ–¥–µ–ª—å spaCy –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.", None
    if not text1 or not text2:
        return "–û—à–∏–±–∫–∞: –û–¥–∏–Ω –∏–ª–∏ –æ–±–∞ —Ç–µ–∫—Å—Ç–∞ –ø—É—Å—Ç—ã –¥–ª—è Embedding.", None

    try:
        doc1 = nlp_model(text1)
        doc2 = nlp_model(text2)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤–µ–∫—Ç–æ—Ä—ã –∏ –∏—Ö –Ω–æ—Ä–º–∞ –Ω–µ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é
        if not doc1.has_vector or not doc2.has_vector or doc1.vector_norm == 0 or doc2.vector_norm == 0:
            # –≠—Ç–æ –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã —Å–æ—Å—Ç–æ—è—Ç —Ç–æ–ª—å–∫–æ –∏–∑ OOV —Å–ª–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–µ–ª–æ–≤
            msg = ("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –æ–±–æ–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ "
                   "(–≤–æ–∑–º–æ–∂–Ω–æ, –æ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ –∏–ª–∏ –ø—Ä–æ–±–µ–ª—ã). –°—Ö–æ–¥—Å—Ç–≤–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ 0.")
            return msg, 0.0

        similarity = doc1.similarity(doc2)
        # –í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö spaCy –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —á—É—Ç—å –≤–Ω–µ [-1, 1] –∏–∑-–∑–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ float
        similarity = max(-1.0, min(1.0, similarity))
        msg = "–°—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ Embeddings (spaCy) —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ."
        # –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º, –Ω–æ –æ–±—ã—á–Ω–æ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ –æ–Ω–æ >= 0
        # –î–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è —Å TF-IDF –∏ Levenshtein (–∫–æ—Ç–æ—Ä—ã–µ 0..1), –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
        # –∏–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ [0, 1], –Ω–∞–ø—Ä–∏–º–µ—Ä, (similarity + 1) / 2, –Ω–æ —ç—Ç–æ –∏—Å–∫–∞–∑–∏—Ç —Å–º—ã—Å–ª.
        # –û—Å—Ç–∞–≤–ª—è–µ–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-1, 1], –Ω–æ —á–∞—â–µ –±—É–¥–µ—Ç [0, 1].
        return msg, float(similarity)
    except Exception as e:
        return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ Embedding —Å—Ö–æ–¥—Å—Ç–≤–∞: {e}", None


def calculate_levenshtein_similarity(text1: str, text2: str) -> tuple[str, float | None]:
    """–í—ã—á–∏—Å–ª—è–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞."""
    if not _LEVENSHTEIN_AVAILABLE:
        return "–û—à–∏–±–∫–∞: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ python-Levenshtein –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.", None

    len1 = len(text1)
    len2 = len(text2)

    # –ï—Å–ª–∏ –æ–±–∞ —Ç–µ–∫—Å—Ç–∞ –ø—É—Å—Ç—ã, –æ–Ω–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
    if len1 == 0 and len2 == 0:
        return "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞: –æ–±–∞ —Ç–µ–∫—Å—Ç–∞ –ø—É—Å—Ç—ã.", 1.0
    # –ï—Å–ª–∏ –æ–¥–∏–Ω –ø—É—Å—Ç, —Å—Ö–æ–¥—Å—Ç–≤–æ 0
    if len1 == 0 or len2 == 0:
        # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–≤–Ω–æ –¥–ª–∏–Ω–µ –Ω–µ–ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ = 0
        return "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞: –æ–¥–∏–Ω –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤ –ø—É—Å—Ç.", 0.0

    try:
        distance = Levenshtein.distance(text1, text2)
        # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 1 - (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ / –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞)
        # –≠—Ç–æ –¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 (—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã–µ) –¥–æ 1 (–∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ)
        max_len = max(len1, len2)
        similarity = 1.0 - (distance / max_len)
        msg = f"–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ = {distance}. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ."
        return msg, float(similarity)
    except Exception as e:
        return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞: {e}", None


# --- Streamlit –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å ---
st.title("–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –°—Ä–∞–≤–Ω–µ–Ω–∏—è –¢–µ–∫—Å—Ç–æ–≤")
st.caption("–ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, TF-IDF, –í–µ–∫—Ç–æ—Ä—ã (Embeddings), –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω")

# --- –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ spaCy (–¥–µ–ª–∞–µ–º –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ) ---
# –ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
nlp_model = None
if _SPACY_AVAILABLE:
    nlp_model = load_spacy_model()
    if nlp_model is None and _SPACY_AVAILABLE:
        st.sidebar.warning("–ú–æ–¥–µ–ª—å spaCy –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.")
    elif not _SPACY_AVAILABLE:
        st.sidebar.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ spaCy –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.")

# --- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å ---
st.sidebar.header("–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –°—Ä–∞–≤–Ω–µ–Ω–∏—è")
# –†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –¥–ª–∏–Ω—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
text_length = st.sidebar.number_input(
    "–ñ–µ–ª–∞–µ–º–∞—è –¥–ª–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö/—Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤:",
    min_value=10,
    max_value=10000,
    value=300,
    step=50,
    help="–£–∫–∞–∂–∏—Ç–µ –¥–ª–∏–Ω—É –≤ —Å–∏–º–≤–æ–ª–∞—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∏ –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∫ —ç—Ç–æ–π –¥–ª–∏–Ω–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏."
)

st.sidebar.header("–í–≤–æ–¥ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¢–µ–∫—Å—Ç–æ–≤")
# –§–æ—Ä–º—ã –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
nat_text1_input = st.sidebar.text_area(
    "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1:",
    height=150,
    key="nat1",
    placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ –ø–µ—Ä–≤—ã–π –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç..."
)
nat_text2_input = st.sidebar.text_area(
    "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 2:",
    height=150,
    key="nat2",
    placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ –≤—Ç–æ—Ä–æ–π –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç..."
)

# –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–Ω–∞–ª–∏–∑–∞
run_button = st.sidebar.button("üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –ê–Ω–∞–ª–∏–∑")

# –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –æ—Ç—á–µ—Ç–∞
st.markdown("---")
st.header("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –°—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –û—Ç—á–µ—Ç")

if run_button:
    # --- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ ---
    results = {}
    texts_used = {}
    comparison_log = []

    # 1. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    st.subheader("1. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç")
    st.markdown("**1.1 –ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ –°—Ö–æ–¥—Å—Ç–≤–æ**")
    msg, perc = compare_texts(nat_text1_input, nat_text2_input)
    comparison_log.append(f"1. Natural vs Natural (Symbolwise): {msg}")
    st.info(msg)
    if perc is not None:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", f"{perc:.4f}")
        results['Natural vs Natural'] = perc
        texts_used['Natural 1'] = nat_text1_input
        texts_used['Natural 2'] = nat_text2_input
    else:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", "N/A")
        results['Natural vs Natural'] = None
        texts_used['Natural 1'] = nat_text1_input
        texts_used['Natural 2'] = nat_text2_input
    st.markdown("---")

    # --- TF-IDF ---
    st.markdown("**1.2 TF-IDF –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ –°—Ö–æ–¥—Å—Ç–≤–æ**")
    if not _SKLEARN_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ scikit-learn –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –†–∞—Å—á–µ—Ç TF-IDF –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.")
    else:
        msg_tfidf, perc_tfidf = calculate_tfidf_similarity(nat_text1_input, nat_text2_input)
        comparison_log.append(f"2.1 Natural vs Natural (TF-IDF): {msg_tfidf}")
        if perc_tfidf is not None:
            st.info(msg_tfidf)
            st.metric("TF-IDF –°—Ö–æ–¥—Å—Ç–≤–æ", f"{perc_tfidf:.4f}")
            results['Natural vs Natural (TF-IDF)'] = perc_tfidf
        else:
            st.warning(msg_tfidf)
            st.metric("TF-IDF –°—Ö–æ–¥—Å—Ç–≤–æ", "N/A")
            results['Natural vs Natural (TF-IDF)'] = None
        st.caption(
            "–ò–∑–º–µ—Ä—è–µ—Ç —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —á–∞—Å—Ç–æ—Ç—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ —Å–ª–æ–≤, –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö –ø–æ –∏—Ö –≤–∞–∂–Ω–æ—Å—Ç–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ (–∑–¥–µ—Å—å - —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–∏—Ö –¥–≤—É—Ö). 1 = –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏ –ø–æ —Å–ª–æ–≤–∞–º, 0 = –Ω–µ—Ç –æ–±—â–∏—Ö —Å–ª–æ–≤ (–∫—Ä–æ–º–µ —Å—Ç–æ–ø-—Å–ª–æ–≤).")

    # --- Embedding Similarity ---
    st.markdown("**1.3 –°—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –û—Å–Ω–æ–≤–µ –í–µ–∫—Ç–æ—Ä–æ–≤ (Embeddings)**")
    if not _SPACY_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ spaCy –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.")
    elif nlp_model is None:
        st.warning("–ú–æ–¥–µ–ª—å spaCy –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.")
    else:
        msg_emb, perc_emb = calculate_embedding_similarity(nat_text1_input, nat_text2_input, nlp_model)
        comparison_log.append(f"2.2 Natural vs Natural (Embedding): {msg_emb}")
        if perc_emb is not None:
            if "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ" in msg_emb:
                st.warning(msg_emb)
            else:
                st.info(msg_emb)
            st.metric("Embedding –°—Ö–æ–¥—Å—Ç–≤–æ (spaCy)", f"{perc_emb:.4f}")
            results['Natural vs Natural (Embedding)'] = perc_emb
        else:
            st.error(msg_emb)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º error –¥–ª—è –æ—à–∏–±–æ–∫ spaCy
            st.metric("Embedding –°—Ö–æ–¥—Å—Ç–≤–æ (spaCy)", "N/A")
            results['Natural vs Natural (Embedding)'] = None
        st.caption(
            "–ò–∑–º–µ—Ä—è–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ (—Å–º—ã—Å–ª–æ–≤–æ–µ) —Å—Ö–æ–¥—Å—Ç–≤–æ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å–ª–æ–≤. –ó–Ω–∞—á–µ–Ω–∏—è –æ—Ç -1 –¥–æ 1 (—á–∞—â–µ 0..1). 1 = –æ—á–µ–Ω—å –±–ª–∏–∑–∫–∏ –ø–æ —Å–º—ã—Å–ª—É, 0 = –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã (–Ω–µ —Å–≤—è–∑–∞–Ω—ã), -1 = –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã (—Ä–µ–¥–∫–æ).")

    # --- Levenshtein Similarity ---
    st.markdown("**1.4 –°—Ö–æ–¥—Å—Ç–≤–æ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ (–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ)**")
    if not _LEVENSHTEIN_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ python-Levenshtein –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –†–∞—Å—á–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.")
    else:
        msg_lev, perc_lev = calculate_levenshtein_similarity(nat_text1_input, nat_text2_input)
        comparison_log.append(f"2.3 Natural vs Natural (Levenshtein): {msg_lev}")
        if perc_lev is not None:
            st.info(msg_lev)
            st.metric("–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω –°—Ö–æ–¥—Å—Ç–≤–æ", f"{perc_lev:.4f}")
            results['Natural vs Natural (Levenshtein)'] = perc_lev
        else:
            st.error(msg_lev)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º error –¥–ª—è –æ—à–∏–±–æ–∫
            st.metric("–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω –°—Ö–æ–¥—Å—Ç–≤–æ", "N/A")
            results['Natural vs Natural (Levenshtein)'] = None
        st.caption(
            "–ò–∑–º–µ—Ä—è–µ—Ç —Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ—Å–∏–º–≤–æ–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫ (–≤—Å—Ç–∞–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –∑–∞–º–µ–Ω–∞) –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ –¥—Ä—É–≥–æ–π. 1 = —Ç–µ–∫—Å—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã, 0 = —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã–µ (–∏–ª–∏ –æ–¥–∏–Ω –ø—É—Å—Ç–æ–π). –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ –æ–ø–µ—á–∞—Ç–∫–∞–º –∏ –ø–æ—Ä—è–¥–∫—É —Å–∏–º–≤–æ–ª–æ–≤.")

    st.markdown("---")

    # --- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ ---
    try:
        rand_letters1 = generate_random_letters(text_length)
        rand_letters2 = generate_random_letters(text_length)
        rand_words1 = generate_random_words(text_length)
        rand_words2 = generate_random_words(text_length)
        texts_used['Random Letters 1'] = rand_letters1
        texts_used['Random Letters 2'] = rand_letters2
        texts_used['Random Words 1'] = rand_words1
        texts_used['Random Words 2'] = rand_words2
    except Exception as e:
        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤: {e}")
        st.stop()

    # --- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ 1 –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π 2 –∏ 3 ---
    # –ü—Ä–∏–≤–æ–¥–∏–º –∫ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω–µ text_length
    nat_text_aligned = None
    if not nat_text1_input:
        msg_nat_align = f"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 –ø—É—Å—Ç. –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –Ω–∏–º (—Å–ª—É—á–∞–∏ 2 –∏ 3) –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã."
        comparison_log.append(msg_nat_align)
        st.warning(msg_nat_align)
    else:
        len_nat1 = len(nat_text1_input)
        if len_nat1 == text_length:
            nat_text_aligned = nat_text1_input
            msg_nat_align = f"–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 –∏–º–µ–µ—Ç –∑–∞–¥–∞–Ω–Ω—É—é –¥–ª–∏–Ω—É {text_length}."
        elif len_nat1 > text_length:
            nat_text_aligned = nat_text1_input[:text_length]
            msg_nat_align = f"–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 (–¥–ª–∏–Ω–∞ {len_nat1}) –±—ã–ª —É—Å–µ—á–µ–Ω –¥–æ –¥–ª–∏–Ω—ã {text_length} –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π 2 –∏ 3."
            comparison_log.append(msg_nat_align)
            st.warning(msg_nat_align)
        else:
            nat_text_aligned = nat_text1_input.ljust(text_length)  # –î–æ–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–±–µ–ª–∞–º–∏ —Å–ø—Ä–∞–≤–∞
            msg_nat_align = f"–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 (–¥–ª–∏–Ω–∞ {len_nat1}) –±—ã–ª –¥–æ–ø–æ–ª–Ω–µ–Ω –ø—Ä–æ–±–µ–ª–∞–º–∏ –¥–æ –¥–ª–∏–Ω—ã {text_length} –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π 2 –∏ 3."
            comparison_log.append(msg_nat_align)
            st.warning(msg_nat_align)

    texts_used['Natural Aligned (for 2, 3)'] = nat_text_aligned

    st.markdown("---")

    # 2. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã
    st.subheader("2. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã")
    if nat_text_aligned:
        msg, perc = compare_texts(nat_text_aligned, rand_letters1)
        comparison_log.append(f"2. Natural vs Random Letters: {msg}")
        st.info(msg)
        if perc is not None:
            st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", f"{perc:.4f}")
            results['Natural vs Random Letters'] = perc
        else:
            st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", "N/A")
            results['Natural vs Random Letters'] = None
    else:
        st.info("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 –Ω–µ –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω.")
        results['Natural vs Random Letters'] = None
    st.markdown("---")

    # 3. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞
    st.subheader("3. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞")
    if nat_text_aligned:
        msg, perc = compare_texts(nat_text_aligned, rand_words1)
        comparison_log.append(f"3. Natural vs Random Words: {msg}")
        st.info(msg)
        if perc is not None:
            st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", f"{perc:.4f}")
            results['Natural vs Random Words'] = perc
        else:
            st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", "N/A")
            results['Natural vs Random Words'] = None
    else:
        st.info("–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç 1 –Ω–µ –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω.")
        results['Natural vs Random Words'] = None
    st.markdown("---")

    # 4. –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã
    st.subheader("4. –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã")
    msg, perc = compare_texts(rand_letters1, rand_letters2)
    comparison_log.append(f"4. Random Letters vs Random Letters: {msg}")
    st.info(msg)
    if perc is not None:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", f"{perc:.4f}")
        results['Random Letters vs Random Letters'] = perc
    else:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", "N/A")
        results['Random Letters vs Random Letters'] = None
    st.markdown("---")

    # 5. –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞ vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞
    st.subheader("5. –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞ vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞")
    msg, perc = compare_texts(rand_words1, rand_words2)
    comparison_log.append(f"5. Random Words vs Random Words: {msg}")
    st.info(msg)
    if perc is not None:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", f"{perc:.4f}")
        results['Random Words vs Random Words'] = perc
    else:
        st.metric("–ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è", "N/A")
        results['Random Words vs Random Words'] = None
    st.markdown("---")

    # --- –ù–∞—á–∞–ª–æ –û—Ç—á–µ—Ç–∞ ---
    st.header("–î–µ—Ç–∞–ª—å–Ω—ã–π –û—Ç—á–µ—Ç")

    # --- –ê–ª–≥–æ—Ä–∏—Ç–º –°—Ä–∞–≤–Ω–µ–Ω–∏—è ---
    st.subheader("–ê–ª–≥–æ—Ä–∏—Ç–º –°—Ä–∞–≤–Ω–µ–Ω–∏—è –¢–µ–∫—Å—Ç–æ–≤")
    st.markdown(f"""
    **1. –ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
    –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ –¥–≤—É—Ö —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö.

    1.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –î–ª–∏–Ω—ã:** –ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞—é—Ç—Å—è –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, `text1` –∏ `text2`. –ü–µ—Ä–≤—ã–º —à–∞–≥–æ–º –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –∏—Ö –¥–ª–∏–Ω—ã, `len1` –∏ `len2`.
    2.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ù–µ—Ä–∞–≤–Ω–æ–π –î–ª–∏–Ω—ã:** –ï—Å–ª–∏ `len1 != len2`, –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–µ, —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª–∏–Ω–Ω–µ–µ –∏ –Ω–∞ —Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –¥–∞–Ω–Ω–æ–º—É –º–µ—Ç–æ–¥—É –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Ç—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω–µ. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ `None`.
    3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ü—É—Å—Ç—ã—Ö –°—Ç—Ä–æ–∫:** –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ —Å—Ç—Ä–æ–∫ –ø—É—Å—Ç–∞—è (`len1 == 0` –∏–ª–∏ `len2 == 0`), —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–æ–±—â–∞–µ—Ç –æ–± —ç—Ç–æ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è `None`.
    4.  **–ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ (–ø—Ä–∏ —Ä–∞–≤–Ω–æ–π –¥–ª–∏–Ω–µ):** –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –Ω–µ–Ω—É–ª–µ–≤—É—é –¥–ª–∏–Ω—É `L`, –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Ç–µ—Ä–∏—Ä—É–µ—Ç –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º –æ—Ç `0` –¥–æ `L-1`. –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ `i` —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è —Å–∏–º–≤–æ–ª—ã `text1[i]` –∏ `text2[i]`.
    5.  **–ü–æ–¥—Å—á–µ—Ç –°–æ–≤–ø–∞–¥–µ–Ω–∏–π:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å—á–µ—Ç—á–∏–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π `matches = 0`. –ï—Å–ª–∏ `text1[i] == text2[i]`, —Å—á–µ—Ç—á–∏–∫ `matches` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1.
    6.  **–†–∞—Å—á–µ—Ç –ü—Ä–æ—Ü–µ–Ω—Ç–∞ –°–æ–≤–ø–∞–¥–µ–Ω–∏–π:** –ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–¥–∞ –ø–æ –≤—Å–µ–º —Å–∏–º–≤–æ–ª–∞–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–æ–ª—è —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∫ –æ–±—â–µ–π –¥–ª–∏–Ω–µ —Å—Ç—Ä–æ–∫–∏: `percentage = matches / L`. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 (–Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è) –¥–æ 1 (–ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤).
    7.  **–í–æ–∑–≤—Ä–∞—Ç –†–µ–∑—É–ª—å—Ç–∞—Ç–∞:** –ê–ª–≥–æ—Ä–∏—Ç–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (—É–∫–∞–∑—ã–≤–∞—è –¥–ª–∏–Ω—É –∏ —á–∏—Å–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π) –∏ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `percentage`.

    **–ü—Ä–∏–º–µ—Ä:**
    `text1 = "–∫–æ—Ç"`
    `text2 = "–∫–∏—Ç"`
    –î–ª–∏–Ω—ã —Ä–∞–≤–Ω—ã 3.
    - `k` == `k` (match = 1)
    - `–æ` != `–∏` (match = 1)
    - `—Ç` == `—Ç` (match = 2)
    –†–µ–∑—É–ª—å—Ç–∞—Ç: `percentage = 2 / 3 ‚âà 0.6667`
    
    **2. TF-IDF –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ –°—Ö–æ–¥—Å—Ç–≤–æ:**
       - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç—ã –∫–∞–∫ –≤–µ–∫—Ç–æ—Ä—ã –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–ª–æ–≤, –≥–¥–µ –≤–µ—Å –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –µ–≥–æ —á–∞—Å—Ç–æ—Ç—ã –≤ —Ç–µ–∫—Å—Ç–µ (TF) –∏ –æ–±—Ä–∞—Ç–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã –≤–æ –≤—Å–µ—Ö —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö (IDF).
       - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ—Å–∏–Ω—É—Å —É–≥–ª–∞ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ (–æ–±—ã—á–Ω–æ 0 –¥–æ 1). 1 –æ–∑–Ω–∞—á–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤–∞–∂–Ω—ã—Ö —Å–ª–æ–≤, 0 - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—â–∏—Ö –∑–Ω–∞—á–∏–º—ã—Ö —Å–ª–æ–≤.
       - –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤, –Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∏—Ö –≤–∞–∂–Ω–æ—Å—Ç—å.
       - –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º.

    **3. –°—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞ –û—Å–Ω–æ–≤–µ –í–µ–∫—Ç–æ—Ä–æ–≤ (Embeddings):**
       - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–∑–¥–µ—Å—å - spaCy) –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤ –≤ –≤–µ–∫—Ç–æ—Ä—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, –æ—Ç—Ä–∞–∂–∞—é—â–∏–µ –∏—Ö —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å–º—ã—Å–ª).
       - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–æ—Ç -1 –¥–æ 1, —á–∞—â–µ 0 –¥–æ 1). 1 –æ–∑–Ω–∞—á–∞–µ—Ç –æ—á–µ–Ω—å –±–ª–∏–∑–∫–∏–µ –ø–æ —Å–º—ã—Å–ª—É —Ç–µ–∫—Å—Ç—ã.
       - –£–ª–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∏–Ω–æ–Ω–∏–º—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—É—é –±–ª–∏–∑–æ—Å—Ç—å —Å–ª–æ–≤.
       - –ú–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ç–æ—á–Ω–æ–º—É –Ω–∞–±–æ—Ä—É —Å–ª–æ–≤, —á–µ–º TF-IDF.

    **4. –°—Ö–æ–¥—Å—Ç–≤–æ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ (–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ):**
       - –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–¥–Ω–æ—Å–∏–º–≤–æ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–≤—Å—Ç–∞–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –∑–∞–º–µ–Ω–∞) –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –¥—Ä—É–≥—É—é.
       - –†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `1 - (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ / –º–∞–∫—Å_–¥–ª–∏–Ω–∞)` (–æ—Ç 0 –¥–æ 1). 1 –æ–∑–Ω–∞—á–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.
       - –û—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –ø–æ—Ä—è–¥–∫—É —Å–∏–º–≤–æ–ª–æ–≤, –æ–ø–µ—á–∞—Ç–∫–∞–º, –Ω–µ–±–æ–ª—å—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º.
       - –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–º—ã—Å–ª —Å–ª–æ–≤ –∏–ª–∏ —Ç–µ–∫—Å—Ç–∞. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫, –ø–æ–∏—Å–∫–∞ –æ–ø–µ—á–∞—Ç–æ–∫, –æ—Ü–µ–Ω–∫–∏ –±–ª–∏–∑–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫ "–∫–∞–∫ –µ—Å—Ç—å".
    """)

    # --- –ü—Ä–∏–º–µ—Ä—ã –¢–µ–∫—Å—Ç–æ–≤ (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞) ---
    st.subheader("–¢–µ–∫—Å—Ç—ã, –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –≤ –ü–æ—Å–ª–µ–¥–Ω–µ–º –°—Ä–∞–≤–Ω–µ–Ω–∏–∏")
    max_display_len = text_length  # –ü–æ–∫–∞–∂–µ–º –¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    for name, text in texts_used.items():
        if text is not None:
            display_text = text[:max_display_len] + ('...' if len(text) > max_display_len else '')
            st.text_area(f"{name} (–î–ª–∏–Ω–∞: {len(text)})", display_text, height=100, key=f"display_{name}", disabled=True)
        else:
            st.write(f"{name}: –¢–µ–∫—Å—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –∏–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è.")
    st.markdown("---")

    # --- –ê–Ω–∞–ª–∏–∑ –ü–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ó–Ω–∞—á–µ–Ω–∏–π ---
    st.subheader("–ê–Ω–∞–ª–∏–∑ –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –°—Ä–∞–≤–Ω–µ–Ω–∏—è")
    st.markdown(f"""
    –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –æ–±—â–∏—Ö —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π):

    *   **1. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π vs –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π:**
        *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* `{results.get('Natural vs Natural', 'N/A')}` (–µ—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏–º—ã)
        *   *–û–∂–∏–¥–∞–Ω–∏—è –∏ –ê–Ω–∞–ª–∏–∑:* –ó–Ω–∞—á–µ–Ω–∏–µ —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –∏ –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤.
            *   –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –∏–ª–∏ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ —Ä–µ–¥–∞–∫—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –∞–±–∑–∞—Ü–∞), –ø—Ä–æ—Ü–µ–Ω—Ç –±—É–¥–µ—Ç –≤—ã—Å–æ–∫–∏–º (–±–ª–∏–∑–∫–∏–º –∫ 1).
            *   –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –Ω–∞ –æ–¥–Ω—É —Ç–µ–º—É, –Ω–æ —Ä–∞–∑–Ω—ã–µ, –ø—Ä–æ—Ü–µ–Ω—Ç –±—É–¥–µ—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–º, —Ç.–∫. –±—É–¥—É—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã, —á–∞—Å—Ç—ã–µ –±—É–∫–≤—ã (–æ, –µ, –∞, –∏, –Ω, —Ç...), –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–ª–æ–≤–∞ –∏–ª–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è.
            *   –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã–µ —Ç–µ–º—ã, –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –±—É–¥–µ—Ç –Ω–∏–∂–µ, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤—ã—à–µ, —á–µ–º —É —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤, –∏–∑-–∑–∞ –æ–±—â–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —è–∑—ã–∫–∞ (—á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å –±—É–∫–≤, –ø—Ä–æ–±–µ–ª—ã). –û–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ä–∞–π–æ–Ω–µ 0.05-0.15 –¥–ª—è —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
        - **–ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ:** –°–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫. –û–±—ã—á–Ω–æ –Ω–∏–∑–∫–æ–µ, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –Ω–µ –∫–æ–ø–∏–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –†–∞—Å—Ç–µ—Ç —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –æ–±—â–∏—Ö —Ñ—Ä–∞–∑ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.
        - **TF-IDF:** –£–º–µ—Ä–µ–Ω–Ω–æ–µ –∏–ª–∏ –≤—ã—Å–æ–∫–æ–µ, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –Ω–∞ –æ–¥–Ω—É —Ç–µ–º—É –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ö–æ–∂—É—é –ª–µ–∫—Å–∏–∫—É. –ù–∏–∑–∫–æ–µ, –µ—Å–ª–∏ —Ç–µ–º—ã —Ä–∞–∑–Ω—ã–µ.
        - **Embedding (spaCy):** –í—ã—Å–æ–∫–æ–µ, –µ—Å–ª–∏ —Ç–µ–∫—Å—Ç—ã –±–ª–∏–∑–∫–∏ –ø–æ —Å–º—ã—Å–ª—É, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ —Å–ª–æ–≤–∞ (—Å–∏–Ω–æ–Ω–∏–º—ã). –ú–æ–∂–µ—Ç –±—ã—Ç—å —É–º–µ—Ä–µ–Ω–Ω—ã–º –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –æ–¥–Ω—É –æ–±—â—É—é —Ç–µ–º—É, –Ω–æ —Å —Ä–∞–∑–Ω—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏.
        - **–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω:** –í—ã—Å–æ–∫–æ–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤. –ë—ã—Å—Ç—Ä–æ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–µ —Å–ª–æ–≤, —Å–∏–Ω–æ–Ω–∏–º–∞—Ö, –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –±—É–∫–≤–∞–ª—å–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è.

    *   **2. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã:**
        *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* `{results.get('Natural vs Random Letters', 'N/A')}`
        *   *–û–∂–∏–¥–∞–Ω–∏—è –∏ –ê–Ω–∞–ª–∏–∑:* –û–∂–∏–¥–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π. –ö–∞–∂–¥—ã–π —Å–∏–º–≤–æ–ª –≤ —Ç–µ–∫—Å—Ç–µ –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω–æ –∏–∑ `{len(RUSSIAN_ALPHABET)}` —Å–∏–º–≤–æ–ª–æ–≤: '{RUSSIAN_ALPHABET[:10]}...'). –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–∞ –Ω–∞ –ª—é–±–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω–∞ `1 / len(RUSSIAN_ALPHABET)`, —Ç.–µ. `1 / {len(RUSSIAN_ALPHABET)} ‚âà {1 / len(RUSSIAN_ALPHABET):.4f}`. –ù–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –¥–æ–ª–∂–µ–Ω —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ —ç—Ç–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é. –ù–µ–±–æ–ª—å—à–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω—ã —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–µ–π –∏ –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —á–∞—Å—Ç–æ—Ç –±—É–∫–≤ –≤ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Ç–µ–∫—Å—Ç–µ.

    *   **3. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞:**
        *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* `{results.get('Natural vs Random Words', 'N/A')}`
        *   *–û–∂–∏–¥–∞–Ω–∏—è –∏ –ê–Ω–∞–ª–∏–∑:* –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –æ–∂–∏–¥–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–º, –Ω–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—à–µ, —á–µ–º –≤ —Å–ª—É—á–∞–µ —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ —Ç–µ–∫—Å—Ç –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ –ø—Ä–æ–±–µ–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Ç–µ–∫—Å—Ç–µ –∏ –º–æ–≥—É—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å –ø–æ –ø–æ–∑–∏—Ü–∏–∏. –¢–∞–∫–∂–µ, –µ—Å–ª–∏ —Å–ª–æ–≤–∞—Ä—å `WORD_LIST` —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∞—Å—Ç–æ—É–ø–æ—Ç—Ä–µ–±–∏–º—ã–µ —Å–ª–æ–≤–∞, –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π —à–∞–Ω—Å –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ü–µ–ª—ã—Ö –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–ª–æ–≤ –∏–ª–∏ –∏—Ö —á–∞—Å—Ç–µ–π. –û–¥–Ω–∞–∫–æ –æ–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤) —Å–ª—É—á–∞–π–Ω–∞, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–º, –æ–±—ã—á–Ω–æ –Ω–µ —Å–∏–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö –±—É–∫–≤.

    *   **4. –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã:**
        *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* `{results.get('Random Letters vs Random Letters', 'N/A')}`
        *   *–û–∂–∏–¥–∞–Ω–∏—è –∏ –ê–Ω–∞–ª–∏–∑:* –≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ 2, –æ–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ `1 / len(RUSSIAN_ALPHABET) ‚âà {1 / len(RUSSIAN_ALPHABET):.4f}` –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π –¥–ª–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞.

    *   **5. –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞ vs –°–ª—É—á–∞–π–Ω—ã–µ —Å–ª–æ–≤–∞:**
        *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* `{results.get('Random Words vs Random Words', 'N/A')}`
        *   *–û–∂–∏–¥–∞–Ω–∏—è –∏ –ê–Ω–∞–ª–∏–∑:* –°–∏—Ç—É–∞—Ü–∏—è –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Å–ª—É—á–∞–π 3. –î–≤–∞ —Ç–µ–∫—Å—Ç–∞ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å–ª–æ–≤ –∏–∑ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–ª–æ–≤–∞—Ä—è, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏. –ü—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ –∏, –≤ –º–µ–Ω—å—à–µ–π —Å—Ç–µ–ø–µ–Ω–∏, —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏ –±—É–∫–≤ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å–ª–æ–≤ –∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–ª–æ–≤ –Ω–∞ –æ–¥–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏. –û–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ã—á–Ω–æ —á—É—Ç—å –≤—ã—à–µ, —á–µ–º `1 / len(RUSSIAN_ALPHABET)`, –∏–∑-–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã "—Å–ª–æ–≤–æ-–ø—Ä–æ–±–µ–ª", –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–º.

    **–í—ã–≤–æ–¥:** –î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é —Å–∏–º–≤–æ–ª–æ–≤. –û–Ω —Ö–æ—Ä–æ—à–æ –æ—Ç–ª–∏—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ) —Ç–µ–∫—Å—Ç—ã –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –Ω–æ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É, –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫—É —Å–ª–æ–≤ –∏–ª–∏ —Å–∏–Ω–æ–Ω–∏–º—ã. –î–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, TF-IDF, –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤/—Ç–µ–∫—Å—Ç–æ–≤, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –∏ —Ç.–¥.).
    - –†–∞–∑–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–∑–º–µ—Ä—è—é—Ç —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Å—Ö–æ–¥—Å—Ç–≤–∞.
    - –ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ - —Å–∞–º–æ–µ "–ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–µ", —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ –∫ –º–∞–ª–µ–π—à–∏–º –æ—Ç–ª–∏—á–∏—è–º.
    - –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω —Ö–æ—Ä–æ—à –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –±—É–∫–≤–∞–ª—å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ —Å—Ç—Ä–æ–∫.
    - TF-IDF –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (–æ–±—â–∏–µ —Å–ª–æ–≤–∞).
    - –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Embeddings) –æ—Ü–µ–Ω–∏–≤–∞—é—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ (—Å–º—ã—Å–ª–æ–≤–æ–µ) —Å—Ö–æ–¥—Å—Ç–≤–æ.
    - –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤.
    
    """)
    st.markdown("---")

    # --- –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ –î–ª–∏–Ω–µ –¢–µ–∫—Å—Ç–∞ ---
    st.subheader("–°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –î–ª–∏–Ω–µ –¢–µ–∫—Å—Ç–∞")
    st.markdown(f"""
    –í—ã–±–æ—Ä –¥–ª–∏–Ω—ã —Ç–µ–∫—Å—Ç–∞ (`L`) –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–∞–∂–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

    
    *   **–ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ä–∞—Å—Ç–µ—Ç —Å –¥–ª–∏–Ω–æ–π.
    *   **–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã. –†–µ–∑—É–ª—å—Ç–∞—Ç (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π) –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª–µ–Ω –Ω–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö.
    *   **TF-IDF:** –†–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∞—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∏—Ö —á–∞—Å—Ç–æ—Ç (—Ö–æ—Ç—è –±—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π). –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ–∫—Å—Ç—ã –º–æ–≥—É—Ç –¥–∞—Ç—å –Ω–µ—Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã.
    *   **Embeddings (spaCy):** –ú–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω—ã –Ω–∞ –±–æ–ª—å—à–∏—Ö –∫–æ—Ä–ø—É—Å–∞—Ö. –û–Ω–∏ –º–æ–≥—É—Ç –¥–∞—Ç—å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –¥–∞–∂–µ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ñ—Ä–∞–∑ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –û–¥–Ω–∞–∫–æ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ —Ü–µ–ª—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ä–∞—Å—Ç–µ—Ç —Å –∏—Ö –¥–ª–∏–Ω–æ–π.

    **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–ª–∏–Ω–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:**
    - **–ü–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–µ/–õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω:** –û—Ç –¥–µ—Å—è—Ç–∫–æ–≤ –¥–æ —Ç—ã—Å—è—á —Å–∏–º–≤–æ–ª–æ–≤. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—Ç–µ—Ç —Å –¥–ª–∏–Ω–æ–π.
    - **TF-IDF:** –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –æ—Ç 50-100 —Å–ª–æ–≤ –∏ –±–æ–ª—å—à–µ.
    - **Embeddings:** –ú–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ç–µ–∫—Å—Ç–∞—Ö, –Ω–æ –ª—É—á—à–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ - –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–æ –∞–±–∑–∞—Ü–µ–≤ –∏ –±–æ–ª–µ–µ.

    *   **–ö–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ–∫—Å—Ç—ã (L < 50-100 —Å–∏–º–≤–æ–ª–æ–≤):**
        *   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–ª—å–Ω–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã —Å–ª—É—á–∞–π–Ω—ã–º —Ñ–ª—É–∫—Ç—É–∞—Ü–∏—è–º. –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –∏–ª–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –º–æ–≥—É—Ç –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç.
        *   –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã –∏ –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã vs –°–ª—É—á–∞–π–Ω—ã–µ –±—É–∫–≤—ã) –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—á–µ—Ç–∫–∏–º–∏.
        *   –ù–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –Ω–∞–¥–µ–∂–Ω—ã—Ö –≤—ã–≤–æ–¥–æ–≤.

    *   **–°—Ä–µ–¥–Ω–∏–µ —Ç–µ–∫—Å—Ç—ã (L = 100-1000 —Å–∏–º–≤–æ–ª–æ–≤):**
        *   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏. –í–ª–∏—è–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è.
        *   –ù–∞—á–∏–Ω–∞—é—Ç –ø—Ä–æ—è–≤–ª—è—Ç—å—Å—è –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ç–µ–æ—Ä–∏–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ—Ü–µ–Ω—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è –∫ `1 / {len(RUSSIAN_ALPHABET)}`).
        *   –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ –ø–∞—Ä —Ç–µ–∫—Å—Ç–æ–≤ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º–∏. –î–ª–∏–Ω–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω —Å–∏–º–≤–æ–ª–æ–≤ (–∫–∞–∫ `L={text_length}` –≤ —Ç–µ–∫—É—â–µ–º –∑–∞–ø—É—Å–∫–µ) —É–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–∏–¥–µ—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è.

    *   **–î–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã (L > 1000 —Å–∏–º–≤–æ–ª–æ–≤):**
        *   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞—é—Ç—Å—è –∫ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–∂–∏–¥–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º (–ø–æ –∑–∞–∫–æ–Ω—É –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª). –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–∞.
        *   –ü–æ–∑–≤–æ–ª—è—é—Ç –≤—ã—è–≤–ª—è—Ç—å –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö —Ç–µ–∫—Å—Ç–æ–≤.
        *   –Ø–≤–ª—è—é—Ç—Å—è –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏–ª–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏.

    **–ö–∞–∫–∞—è –¥–ª–∏–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞?**

    *   –î–ª—è **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π** –∏ —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –ø—è—Ç—å—é —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏, –¥–ª–∏–Ω—ã –≤ **200-500 —Å–∏–º–≤–æ–ª–æ–≤** –æ–±—ã—á–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.
    *   –î–ª—è **–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞**, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Ä–∞–∑–ª–∏—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤ —Å –Ω–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–∏–º–∏—Å—è —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞), —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –¥–ª–∏–Ω–æ–π **–Ω–µ –º–µ–Ω–µ–µ 1000 —Å–∏–º–≤–æ–ª–æ–≤**, –∞ –ª—É—á—à–µ ‚Äì –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—ã—Å—è—á.
    *   –í **–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏**, –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (–∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ —Ç–µ–∫—Å—Ç—ã –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤), –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–∏–ª–ª–∏–æ–Ω—ã –∏ –º–∏–ª–ª–∏–∞—Ä–¥—ã —Å–∏–º–≤–æ–ª–æ–≤/–±–∏—Ç) –∏ —Å–ª–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –º–∞–ª–µ–π—à–∏—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –∏–¥–µ–∞–ª—å–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏.

    **–í—ã–≤–æ–¥:** –î–ª—è –∑–∞–¥–∞—á–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–∞—Ä —Ç–µ–∫—Å—Ç–æ–≤, –≤—ã–±—Ä–∞–Ω–Ω–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª–∏–Ω–∞ `{text_length}` –∏–ª–∏ –ª—é–±–∞—è –¥–ª–∏–Ω–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ç–µ–Ω —Å–∏–º–≤–æ–ª–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–π. –î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª–µ–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–∞—è –¥–ª–∏–Ω–∞.
    –î–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º TF-IDF –∏ Embeddings, –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –¥–ª–∏–Ω–æ–π —Ö–æ—Ç—è –±—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏–ª–∏ –∞–±–∑–∞—Ü. –î–ª—è –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –¥–ª–∏–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏. –î–ª–∏–Ω–∞ `{text_length}` –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.
    """)
    st.markdown("---")

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    with st.expander("–ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–π"):
        for log_entry in comparison_log:
            st.text(log_entry)

else:
    st.info(
        "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É '–ó–∞–ø—É—Å—Ç–∏—Ç—å –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –ê–Ω–∞–ª–∏–∑' –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.")
    if not _SKLEARN_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ scikit-learn –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. TF-IDF –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.")
    if not _SPACY_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ spaCy –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.")
    if not _LEVENSHTEIN_AVAILABLE:
        st.warning("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ python-Levenshtein –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.")
